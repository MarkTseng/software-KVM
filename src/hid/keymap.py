"""Keyboard and mouse key mappings for CH9329."""

from enum import IntEnum


class SpecialKeyCode(IntEnum):
    ENTER = 0x28
    ESCAPE = 0x29
    BACKSPACE = 0x2A
    TAB = 0x2B
    SPACEBAR = 0x2C
    CAPS_LOCK = 0x39
    F1 = 0x3A
    F2 = 0x3B
    F3 = 0x3C
    F4 = 0x3D
    F5 = 0x3E
    F6 = 0x3F
    F7 = 0x40
    F8 = 0x41
    F9 = 0x42
    F10 = 0x43
    F11 = 0x44
    F12 = 0x45
    PRINTSCREEN = 0x46
    SCROLL_LOCK = 0x47
    PAUSE = 0x48
    INSERT = 0x49
    HOME = 0x4A
    PAGEUP = 0x4B
    DELETE = 0x4C
    END = 0x4D
    PAGEDOWN = 0x4E
    RIGHTARROW = 0x4F
    LEFTARROW = 0x50
    DOWNARROW = 0x51
    UPARROW = 0x52
    APPLICATION = 0x65
    LEFT_CTRL = 0xE0
    LEFT_SHIFT = 0xE1
    LEFT_ALT = 0xE2
    LEFT_WINDOWS = 0xE3
    RIGHT_CTRL = 0xE4
    RIGHT_SHIFT = 0xE5
    RIGHT_ALT = 0xE6
    RIGHT_WINDOWS = 0xE7


class MouseButtonCode(IntEnum):
    LEFT = 0x01
    RIGHT = 0x02
    MIDDLE = 0x04


class KeyMap:
    KEYBOARD_MAP = {
        0x04: 0x1E, 0x05: 0x1F, 0x06: 0x20, 0x07: 0x21, 0x08: 0x22,
        0x09: 0x23, 0x0A: 0x24, 0x0B: 0x25, 0x0C: 0x26, 0x0D: 0x27,
        0x0E: 0x2D, 0x0F: 0x2E, 0x10: 0x2F, 0x11: 0x30, 0x12: 0x31,
        0x13: 0x32, 0x14: 0x33, 0x15: 0x34, 0x16: 0x35, 0x17: 0x36,
        0x18: 0x37, 0x19: 0x38, 0x1A: 0x39, 0x1B: 0x2B, 0x1C: 0x33,
        0x1D: 0x34, 0x1E: 0x4F, 0x1F: 0x50, 0x20: 0x51, 0x21: 0x52,
        0x22: 0x53, 0x23: 0x54, 0x24: 0x55, 0x25: 0x56, 0x26: 0x57,
        0x27: 0x58, 0x28: 0x59, 0x29: 0x5A, 0x2B: 0x2C, 0x2C: 0x1E,
        0x2D: 0x1F, 0x2E: 0x20, 0x2F: 0x21, 0x30: 0x22, 0x31: 0x23,
        0x32: 0x24, 0x33: 0x25, 0x34: 0x26, 0x35: 0x27, 0x36: 0x2D,
        0x37: 0x2E, 0x38: 0x2F, 0x39: 0x30, 0x3A: 0x31, 0x3B: 0x32,
        0x3C: 0x33, 0x3D: 0x34, 0x3E: 0x35, 0x3F: 0x36, 0x40: 0x37,
        0x41: 0x38, 0x42: 0x39, 0x43: 0x2B, 0x44: 0x33, 0x45: 0x34,
        0x46: 0x4F, 0x47: 0x50, 0x48: 0x51, 0x49: 0x52, 0x4A: 0x53,
        0x4B: 0x54, 0x4C: 0x55, 0x4D: 0x56, 0x4E: 0x57, 0x4F: 0x58,
        0x50: 0x59, 0x51: 0x5A, 0x52: 0x2C, 0x53: 0x1E, 0x54: 0x1F,
        0x55: 0x20, 0x56: 0x21, 0x57: 0x22, 0x58: 0x23, 0x59: 0x24,
        0x5A: 0x25, 0x5B: 0x26, 0x5C: 0x27, 0x5D: 0x2D, 0x5E: 0x2E,
        0x5F: 0x2F, 0x60: 0x30, 0x61: 0x31, 0x62: 0x32, 0x63: 0x33,
        0x64: 0x34, 0x65: 0x35, 0x66: 0x36, 0x67: 0x37, 0x68: 0x38,
        0x69: 0x39,
    }

    US_KEYBOARD_MAP = {
        65: 0x04, 66: 0x05, 67: 0x06, 68: 0x07, 69: 0x08,
        70: 0x09, 71: 0x0A, 72: 0x0B, 73: 0x0C, 74: 0x0D,
        75: 0x0E, 76: 0x0F, 77: 0x10, 78: 0x11, 79: 0x12,
        80: 0x13, 81: 0x14, 82: 0x15, 83: 0x16, 84: 0x17,
        85: 0x18, 86: 0x19, 87: 0x1A, 88: 0x1B, 89: 0x1C,
        90: 0x1D,
        49: 0x1E, 50: 0x1F, 51: 0x20, 52: 0x21, 53: 0x22,
        54: 0x23, 55: 0x24, 56: 0x25, 57: 0x26, 48: 0x27,
        189: 0x2D, 187: 0x2E,
        219: 0x2F, 221: 0x30, 220: 0x31,
        59: 0x33, 222: 0x34,
        188: 0x36, 190: 0x37, 191: 0x38,
        192: 0x35,
        32: 0x2C,
    }

    QT_KEY_MAP = {
        0x01000000: 0x29,
        0x01000001: 0x2B,
        0x01000003: 0x2A,
        0x01000004: 0x28,
        0x01000005: 0x28,
        0x20: 0x2C,
        0x01000020: 0x39,
        0x01000021: 0x2C,
        0x1000012: 0x50,
        0x1000013: 0x52,
        0x1000014: 0x4F,
        0x1000015: 0x51,
        0x01000029: 0x33,
        0x0100002A: 0x2A,
        0x01000030: 0x3A,
        0x01000031: 0x3B,
        0x01000032: 0x3C,
        0x01000033: 0x3D,
        0x01000034: 0x3E,
        0x01000035: 0x3F,
        0x01000036: 0x40,
        0x01000037: 0x41,
        0x01000038: 0x42,
        0x01000039: 0x43,
        0x0100003A: 0x44,
        0x0100003B: 0x45,
        0x01000050: 0x49,
        0x01000051: 0x4C,
        0x01000052: 0x4D,
        0x01000053: 0x4A,
        0x01000054: 0x4B,
        0x41: 0x04, 0x42: 0x05, 0x43: 0x06, 0x44: 0x07, 0x45: 0x08,
        0x46: 0x09, 0x47: 0x0A, 0x48: 0x0B, 0x49: 0x0C, 0x4A: 0x0D,
        0x4B: 0x0E, 0x4C: 0x0F, 0x4D: 0x10, 0x4E: 0x11, 0x4F: 0x12,
        0x50: 0x13, 0x51: 0x14, 0x52: 0x15, 0x53: 0x16, 0x54: 0x17,
        0x55: 0x18, 0x56: 0x19, 0x57: 0x1A, 0x58: 0x1B, 0x59: 0x1C,
        0x5A: 0x1D,
        0x30: 0x27, 0x31: 0x1E, 0x32: 0x1F, 0x33: 0x20, 0x34: 0x21,
        0x35: 0x22, 0x36: 0x23, 0x37: 0x24, 0x38: 0x25, 0x39: 0x26,
        33: 0x1E, 64: 0x1F, 35: 0x20, 36: 0x21, 37: 0x22,
        94: 0x23, 38: 0x24, 42: 0x25, 40: 0x26, 41: 0x27,
        43: 0x2E, 44: 0x36, 45: 0x2D, 46: 0x37, 47: 0x38,
        95: 0x2D, 124: 0x31, 58: 0x33, 34: 0x34, 60: 0x36, 62: 0x37, 63: 0x38,
        91: 0x2F, 92: 0x31, 93: 0x30, 96: 0x35, 126: 0x35,
    }

    @classmethod
    def get_hid_code(cls, keycode: int) -> int:
        result = cls.QT_KEY_MAP.get(keycode, 0x00)
        if result == 0x00:
            if keycode >= 0x41 and keycode <= 0x5A:
                return (keycode - 0x41) + 0x04
            elif keycode >= 0x30 and keycode <= 0x39:
                return cls.QT_KEY_MAP.get(keycode, 0x00)
        return result
